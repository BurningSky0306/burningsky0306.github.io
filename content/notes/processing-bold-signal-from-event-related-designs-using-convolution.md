---
date: '2025-03-12T01:31:38+08:00'
draft: false
title: '利用卷积对事件相关设计的 BOLD 信号进行处理'
categories: ["psychology", "cognitive neuroscience", "statistical analysis"]
tags: ["experiment design", "data processing", "fmri"]
math: true
---

本文介绍了如何通过卷积运算处理事件相关设计的 BOLD 信号数据，解释了如何从实验数据中提取各刺激对应的血流动力学响应函数(HRF)。

<!--more-->

## 利用卷积使得事件相关设计和 BOLD 信号相结合

由于 Bold 信号恢复到基线水平所需要的时间很长，而事件相关设计一般要求信号恢复到基线水平比较快，因此一般情况下不考虑在以 Bold 信号为实验数据的研究中使用事件相关设计。

但是结合最终的实验数据和实验施加刺激的时间点数据，结合卷积可以逆运算出单独某个刺激所对应的血流动力学响应方程（Hemodynamic Response Function, HRF）

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741698898233.png)

如上图 a 所示，左侧图一可以用函数 f 表示，其可以表明某一个独立的刺激所引发的信号变化。左侧图二可以用函数 g 表示，其可以表明随着时间的流逝，在哪些时间点会出现刺激。将函数 f 和函数 g 卷积就可以得到左侧图三的最终信号。

如上图 b 所示，无论左侧图二函数 g 中，刺激出现的间隔时间有多短，都可以通过函数 f 和函数 g 的卷积得到左侧图三。

因此，类比到 BOLD 信号的处理当中来，g 函数就是关于实验过程中何时向被试施加刺激的时间点的函数，最终的信号就是实验收集到的 BOLD 信号，只需要进行逆向卷积，就可以得到每一个刺激所引发的独立的 BOLD 信号，即 HRF

此外，一般认为不同的实验刺激所引发的 HRF 存在不同的峰值，但是一个完整的 HRF 所经历的时间是相同的。

> 图中的 * 表示卷积运算，并非简单的相乘

以四水平实验设计为例，其 BOLD 信号的表达式为：

$$y=f_{1}*g_{1}+f_{2}*g_{2}+f_{3}*g_{3}+f_{4}*g_{4}$$

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741700547273.png)

假设只有一名被试，那么 \\(y\\)  代表一名被试最终收集到的 BOLD 信号，\\(f_{n}\\)  代表被试在接受第 \\(n\\)  水平的实验处理时的 HRF，\\(g_{n}\\)  代表第 n 水平的施加刺激的时间函数。

对上述表达式进行逆运算就可以得出不同实验处理水平下被试被引发的 HRF 

综上所述，对于不同的实验设计的 BOLD 信号的处理分为如下三种：

1. BOLD 信号 + 组块设计：采用一般线性回归模型 GLM 进行数据分析，最终得到的分析结果为不同实验处理水平对应的斜率 \\(\beta\\) 
2. BOLD 信号 + 事件相关设计：采用卷积的逆运算进行数据分析，最终得到的分析结果为不同实验处理水平对应的 HRF（主要关注其峰值）
3. BOLD 信号 + 组块设计 + 事件相关设计：这种混合设计更加复杂，不再过多叙述。

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741700790515.png)
