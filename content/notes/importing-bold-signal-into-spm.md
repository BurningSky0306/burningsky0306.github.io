---
date: '2025-03-12T01:20:15+08:00'
draft: false
title: '向 SPM 中录入 BOLD 信号'
categories: ["psychology", "cognitive neuroscience", "statistical analysis"]
tags: ["matlab", "spm", "fmri"]
math: true
---

本文介绍了如何在 SPM 软件中正确录入和拼接不同实验设计（包括完全随机设计、随机区组设计和被试内设计）的多名被试的 BOLD 信号数据，并介绍了设计矩阵的构建方法。

<!--more-->

## 单被试且被试内实验设计以外的实验设计的数据录入

单名被试且被试内实验设计只有一名被试的一组数据，不涉及数据拼接的过程。

对于多名被试的数据，数据拼接采用的方法是将每名被试的数据按照一定顺序首尾相连。例如对于水平 1 的N 名被试，将第一名被试的最后一个 Bold 信号快照和第二名被试的第一个 Bold 信号快照相连接，同理连接后续该水平的所有被试以及整个实验的所有被试的数据。

如下图所示，单因素三水平完全随机被试间实验设计：

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741694318952.png)

上图右侧窗口是在 MATLAB 中对 fMRI 等设备收集的数据（尤其是组块设计的实验数据）进行统计分析的 MATLAB 包 SPM 

图中总共有 3×6=18 名被试，总共 3 个实验处理水平，每个水平 6 名被试。一行代表一个被试的所有数据，一列代表一种实验处理水平。黑白块分别代表哑变量的数值，图中白色代表 1，黑色代表 0 。图中的设计矩阵就应该是

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741713812098.png)

上图左侧窗口中的标号①表示首尾相连各个被试的数据，标号②表示使用对比向量 \\(C^{T}\\)  来进行两次比较，首先比较水平 1 和水平 2 的差异，然后比较水平 1 和水平 3 的差异。

如下图所示，对于单因素两水平随机区组实验设计或被试内实验设计

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741697138783.png)

在上方右侧窗口中，每两行代表一个被试及其所有数据。前两列是实验处理水平的哑变量，白色代表 1， 黑色代表 0。每名被试在两个水平下都有实验数据，因此一行代表接受水平 1 的处理，一行代表接受水平 2 的处理。

从第三列开始，在随机区组实验设计中，每列代表一个区组；在被试内实验设计中，每列代表一名被试。因此三列之后的哑变量的含义取决于实验类型。

由于区组之间的差异或被试间的差异不是实验关注的重点，实验重点关注不同水平之间的差异，因此左侧窗口只规定了对比向量 \\(C^{T}=[1, -1]\\)  用来比较水平间差异。

此外，混合实验设计的数据录入同理，但是相对更加复杂，本文不再讨论。

综上所述，多被试的数据录入的准则如下：

1. 被试与被试的数据首尾相连，依次录入
2. 对于更加复杂的随机区组实验设计和被试内实验设计，需要在设计矩阵 \\(X\\)  中体现对应数据所属的区组或被试