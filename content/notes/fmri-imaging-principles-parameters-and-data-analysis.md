---
date: '2025-03-12T01:38:06+08:00'
draft: false
title: 'fMRI 成像原理，参数以及数据分析'
categories: ["psychology", "cognitive neuroscience", "statistical analysis"]
tags: ["data processing", "fmri", "neuroimaging"]
math: true
---

本文介绍了 fMRI 的成像原理、参数设置、实验流程以及数据预处理和分析方法，包括运动矫正、时间矫正、空间标准化和统计分析等关键步骤。

<!--more-->

## fMRI 成像

### 成像的原理

fMRI 成像利用的是含氧血红蛋白的逆磁性与脱氧血红蛋白的顺磁性。

### 成像的参数

成像的类型

1. MRI 结构像：又被称为 T1 像，是对大脑白质和灰质进行成像，其目的是将不同被试的具有个体差异的脑区在后期进行信号分析前通过数学方法转换成统一标准脑区。
2. fMRI 功能像：又被称为 T2 像或 T2* 像，是对 BOLD 信号进行成像，其目的在于利用收集到的数据进行实验效应的分析。

> 设置不同的参数就能够控制机器成不同类型的像。

成像的次数

1. Run：表示对于一名被试从开机到结束实验这样一个连续的扫描有多少次
2. Session：表示一名被试一天之内要接受多少个 Run

成像的时间指标

1. TR：指在多长时间内对被试施加单次连续的外加磁场脉冲。由于理论上从前一次施加连续外加磁场脉冲开始到下一次施加连续外加磁场脉冲开始，需要对被试的大脑进行一次完整扫描，因此 TR 也可以是完整扫描一次大脑的时间。当 TR 变长，留给完整扫描一次大脑的时间就会更加充足，但是实验总时长就会延长。
2. TE：指当开始施加连续外加磁场脉冲到开始接受大脑返回的电磁波之间的时间间隔。由于大脑不同部位对电磁脉冲的信号返回时间是不同的，因此 TE 的设定将会影响机器究竟是结构成像还是功能成像。
3. Time Point：时间点，指向被试施加多少个连续的外加磁场脉冲，也就是能够获取到多少张不同时间点的大脑结构像或功能像的快照。
4. 总时长：TR 和 Time Point 的乘积

成像的空间指标

1. 视野（Field of View, FOV）：由机器扫描确定的对大脑哪些部位进行二维成像的成像范围
2. 矩阵大小（Matrix）：指对 FOV 采用几乘几的像素矩阵对各个部位的激活进行扫描（矩阵大小不变，像素点越大，分辨率越低）
3. 层厚（Thickness, THK）：指每一层成像的像素点有多厚，用于描述三维成像
4. 层数（Slice Number）：指一共成像多少层
5. 间隔（Gap）：指每一层成像之间的间隔有多大（现今已经可以实现无间隔成像）
6. 体素（Voxel）：指三维成像中最小的立体成像单位，本质等于像素乘以层厚

## fMRI 实操的细节

1. 被试需要躺下进入机器才能开始实验
2. 头的部位需要放置海绵和枕头等，防止被试感到不适
3. 幽闭恐惧症患者，体内含有金属的患者，无法适应噪音的被试，老人小孩，皆不适宜进行 fMRI 实验

## fMRI 数据的预处理

> fMRI 数据的预处理和后续的正式处理所使用到的软件都是基于 MATLAB 的 SPM 软件

1. 运动矫正：将实验过程中的不规则头动等因素带来的信号干扰矫正回去
2. 时间矫正：将扫描不同层之间存在的时间间隔带来的信号干扰矫正回去
3. 结构像与功能像的对齐配准
4. 将信号标准化到 MNI 的 EPI 模板：也就是将不同被试的脑区存在的个体差异通过矫正到一个标准化的脑区来消除
5. 通过滤波实现空间平滑和时间平滑

## fMRI 数据的处理

每一个体素都可以绘制一个横坐标为时间，纵坐标为该体素的 BOLD 信号的函数。被激活的体素将会出现波浪起伏的 BOLD 信号，用一般线性回归模型对该信号进行分析就能够得到不同实验水平下该体素激活程度的差异，用 \\(\Delta{\beta}\\)  表示，进而可以对 \\(\Delta{\beta}\\)  进行显著性检验。

当对所有被扫描到的体素进行 \\(\Delta{\beta}\\)  的计算后，就能够据此绘制出“差异脑”图像。如下图所示，不同的颜色代表 \\(\Delta{\beta}\\)  的值和显著情况。

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741713209399.png)

由于体素被设置的足够小，因此最终的实验数据也会有特别多的体素，那么只要愿意对每一个体素在不同实验水平下的激活水平差异进行显著性检验，就一定能够得到某些体素的假阳性的显著结果，即出现由随机误差所引发的一类错误。

因此需要控制一类错误率。

对此，传统的控制一类错误率的方法是将 Z/t 检验换为 F 检验，那么引申到 fMRI 数据的处理当中来，就应该把不同的体素视为一个自变量并改用方差分析，但是实际科研当中的做法是跳过方差分析的步骤，只进行事后比较，用事后比较当中控制一类错误的方法来避免得到假阳性的结果。

这里存在两种控制方法：

1. Family Wise Error, FWE 校正 ：其逻辑是通过需要两两比较的总次数和所有比较所允许的总的一类错误率来计算将每一次两两比较的一类错误率设定为多少合适。具体运用的方法是 Bonferroni 校正法，即用原定的 \\(\alpha\\)  除以所有体素需要比较的总次数来得到新的更加严格的 \\(\alpha\\)  ，用该 \\(\alpha\\)  来作为任意一个体素进行显著性检验需要比较的阈值。该方法是最严格的一种控制一类错误的方法。若研究关注的兴趣区包含的体素较少，那么可以针对该兴趣区内的体素使用 FWE 校正。
2. False Discovery rate, FDR 校正：通过一种复杂的数学计算方法，计算出所有进行了两两比较并得到了阳性结果的比较中实际为假阳性结果的概率，若概率在可承受范围内，即认为最终的比较结果是合理的。具体的运用方法是 Benjamin - Hochberg 校正法。该方法适用于对整个大脑所有得到显著结果的体素进行校正。

此后，若某些得到显著结果的体素相隔较近且位于相同脑区，那么可以将其合并，视为整个脑区或该脑区的某些部位的激活。

后续在得到了所有显著激活结果的体素并使用 FDR 校正了之后，再根据研究关注的兴趣区（Region of Interst, ROI），将兴趣区内的体素单独使用一般线性回归模型进行数据分析，比较在兴趣区内的这些体素上不同的实验处理水平之间的差异究竟是怎样的。

具体的比较方法是将兴趣区内的所有体素的不同的 \\(\beta_{n}\\)  值算平均得到 \\(\overline{\beta_{n}}\\)  ，由于每一个 \\(\beta\\)  都对应了一个哑变量，也就对应了一个实验处理水平，因此这样就得到了该兴趣区在不同实验处理水平下的激活水平了，然后就可以进行后续的 Z/t 检验或方差分析，此时就可以使用 FWE 校正来控制一类错误率。

兴趣区选择和统计分析示例如下：

![](https://s3.bitiful.net/myblogresourcebucket/docs/1741713261059.png)

> 兴趣区的设定依据研究者的主观意愿，一般会结合前人文献和研究假设来确定

> 此外，除了对兴趣区进行分析，也可以对其他同样得到显著结果但是并不处于兴趣区范围内的脑区进行分析