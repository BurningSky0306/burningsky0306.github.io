---
date: '2025-03-10T22:01:35+08:00'
draft: false
title: 'EEG 和 ERP 简介'
categories: ["psychology", "cognitive neuroscience"]
tags: ["eeg", "erp"]
math: true
---

本文介绍了 EEG 和 ERP 的基本原理、信号组成、电极放置、预处理步骤、分析方法及研究前沿，涵盖了从数据采集到成分分析的部分流程及傅里叶变换在脑电研究中的应用。

<!--more-->

### 记录到的电位的组成

诱发电位： Evoked Potential。实验刺激引发的电位，是研究关注的重点。

自发电位： Spontaneous Potential

伪迹和噪音：包含皮肤电，眼电，心电，皮肤电，肌电……。伪迹是与实验无关的一些生理活动所伴随的电位，是系统误差。噪音是随机误差。


> EEG 只能记录到大脑浅层信号且只能记录到突触后电位。

### 自发电位包含下面几种不同频段

1. \\(\delta\\)：1-4Hz
2. \\(\theta\\)：4-8Hz
3. \\(\alpha\\)：8-12Hz
4. \\(\beta\\)：12-30Hz
5. \\(\gamma\\)：30Hz以上

> 这些信号对应的频率没有严格且明确的规范，只要是大致范围内即可

### 刺激间隔的安排

一个 trial 能够激发一次诱发电位，相邻两个 trial 的时间间隔不能太短，两个 trial 之间的时间间隔被称为 SOA，其是指前一个刺激开始到下一个刺激开始的时间间隔。此外， ISI 是指前一个刺激结束到下一个刺激开始的时间间隔。

一般情况下 ISI 在800ms及以上即可，多为1s，1.2s和1.5s


### 电极的放置位置

电极安放存在多种方式，例如10/20系统，10/10系统，10/5系统等

![](https://raw.githubusercontent.com/BurningSky0306/Img/main/Img/202503102205023.png)

英文字母缩写代表电极所在的脑区。左半球为奇数，右半球为偶数。越往两边走离中轴线越远且数字越大。M1 和 M2 放置在耳垂上，目的是为了和其他电极形成电势差以测量电压，因此也被称为参考电极。参考电极有些时候也会选择乳突，其位置位于耳后突出的部分。

### 电极安放的细节

对于高电阻的电极的安放：

1. 带上电极帽，使用钝头注射器穿过电极孔来注射电极膏（实际上就是面粉加水）
2. 压电极的时候要压紧一点

对于低电阻的电极的安放：

1. 不用打导电膏，更加舒适，更加安全，适合婴儿小孩
2. 由于电阻更低，因此更容易受到皮肤电的干扰，可以通过提前洗头或增加试次来降低影响


### 脑电信号的预处理

首先打 Trigger。实际上就是确定在整个流程中计划要在哪些时间点施加刺激并对其进行记录

其次滤波。

![](https://raw.githubusercontent.com/BurningSky0306/Img/main/Img/202503102205326.png)

A图是实际记录到脑电信号，其横坐标为时间，纵坐标为信号强度，这种信号表达方式是时域表达。

B图则是利用A图记录到的数据经过傅里叶变换得到的脑电信号，其横坐标为脑电频率，纵坐标为信号强度，这种信号表达方式是频域表达。

A图中的高频低波幅的脑电信号对应了B图的60hz低强度信号。

一般情况下需要将小于1Hz和大于30hz的信号过滤掉。

进而，在A图的原始脑电信号的基础上减去60hz正弦波的异常脑电就得到了E图更加平滑且去除了干扰信号的脑电，实现了滤波。

> 傅里叶变换的逻辑是认为任何一种连续变化的信号都可以还原成有限个数的正弦波。进而可以得到信号的频率和强度。

此外，除了通过滤波来去除伪迹以外，还可以通过人为的肉眼校正（主观性较强，不推荐）和设置上下阈限来去除异常电极信号。

然后是 ICA 法去除伪迹（Independent Content Analysis，独立成分分析）

该方法能够通过傅里叶变换将原始的混合脑电信号转换成相对独立的不同频率和强度的正弦波，并且显示出不同的正弦波在大脑皮层各个脑区分布的概率密度。

![](https://raw.githubusercontent.com/BurningSky0306/Img/main/Img/202503102206964.png)

如图所示，通过插件可以实现脑电信号来源的估计并给出准确率的估计值。研究者可以根据估计的概率大小来有选择的去除特定的脑电信号。

然后将每个 Trigger 所激发的诱发电位分段，得到所有 Trigger 的分段脑电信号。

然后是基线校正。随着实验的进行，脑电信号可能出现频率比较低的漂移，导致前后间隔时间比较长的 Trigger 所对应的脑电信号强度差距过大。对此，可以用每个 Trigger 对应的脑电信号减去该 Trigger 前 50 到 100ms 左右的非诱发电位的脑电信号，从而得到该 Trigger 的相对诱发电位。

然后在基线校正过后再进行叠加平均法，指将前面处理好的每个 Trigger 的脑电信号叠加起来并计算平均值就能够消除随机产生且影响效果随机的噪音信号。

最后，在实际科研当中，不可能只有一种类型的 Trigger ，因此需要相应类型的 Trigger 分别叠加平均。此外，除了可以同一个被试不同类型的 Trigger 分别叠加平均，还可以相同组或全部的被试的同一类型的 Trigger 叠加平均。

### 脑电的其他细节

上述的信号预处理都是事后补救措施，为了提高数据质量，更好的方法是在实验开始前就尽量避免无关因素影响实验过程。对此可以采用如下几种方法：

1. 提前告知被试实验要求，引起被试重视
2. 告知被试高质量的数据将会得到更高的报酬
3. 合理安排被试在实验过程中的休息时间

### 判断脑电信号质量的一种方法

观察叠加平均后的 Trigger 的前面大约 50 到 100ms 的基线信号是否稳定。如果不稳定，说明研究存在一定问题，研究内部效度降低。这可能有两种原因，其一是 Trigger 之间的 ISI 设置得太短，其二是伪迹和噪音控制的很差。

### 脑电信号的正式处理

在信号的预处理之后，就得到了 EP（Evoked Potential，诱发电位），由于这种 EP 是和刺激事件绑定的，因此进一步能够得到 ERP（Event-Related Potential，事件相关电位）。

在此基础上就可以进一步提取信号的成分。

### 典型的脑电成分

脑电成分的命名，其中 P（positive）代表正波，N（negative）代表负波。

P100, P200, P300……分别代表100ms左右，200ms左右，300ms 左右出现的正波，负波命名同理。

P1, P2, P3……分别代表出现的第一个，第二个，第三个正波，负波命名同理。此外，其也有可能代表100ms, 200ms, 300ms 左右出现的正波。具体情况具体分析，脑电成分的命名没有标准规范。

### 脑电成分分析的步骤

1. 设置时间窗：设置一个时间窗，用它把自己关心的脑电成分框起来，计算这段时间内的不同处理条件下的脑电信号的各自的平均值，这就是这段时间内的因变量指标。
2. 具体时间窗的设置取决于研究目的和前人文献，研究目的确定了研究关注的脑电类型，前人文献确定了哪些脑电成分与特定的脑电类型有关。
3. 此外，在自己的研究当中需要论证选取的脑电成分的确反映了研究目的所关注的脑电类型。对此，可以计算脑电指标和行为指标的相关来论证。

在实际的科研当中，很少事前确定时间窗，而是从 0ms 开始依次对每一个能够记录数据的时间点进行差异显著性检验并期望能够检验出显著效应。如果存在显著的时间点但其是孤立的，那么这可能反映了随机误差；如果存在连续的且显著的时间点，那么这可能暗示了实验处理效应的存在，对此就可以设置时间窗。此后，再去查文献，寻找相关解释。

这种方法由于会进行多次检验，是数据驱动的结果，因此会导致一，二类错误累加，得到假阳性的结果。为了确保结论的正确性，理应重复验证，但实际上很少人会这么做。

## 脑电研究的前沿

### ERP 的定位问题

上述关于 EEG 和 ERP 的内容是比较传统比较经典的研究范式，最新的 EEG 领域的前沿科学关注的是如何解决 EEG 信号定位难的问题。

研究假设脑袋中存在一些放电的偶极子，脑电设备记录到的电信号就是来源于这些偶极子。偶极子的正运算就是从偶极子的具体位置得到实际接收到的脑电信号，偶极子的负运算就是从实际接收到的脑电信号得到偶极子的具体位置。但实际上偶极子的负运算非常困难且结果不可靠，这是由脑电设备本身的性质决定的。

### 短时傅里叶变换 STFT 和快速傅里叶变换 FFT

![](https://raw.githubusercontent.com/BurningSky0306/Img/main/Img/202503102206282.png)

在之前的滤波当中，傅里叶变换可以将脑电信号的时域表达转换为频域表达，得到一段脑电信号所对应的正弦波的组成。它是直接对全程脑电信号进行傅里叶变换的。

在短时傅里叶变换中，则是对设定的时间窗内的脑电信号的进行傅里叶变换，时间窗的起止点和全域由研究者决定。

此外，该方法还关注不同频率的正弦波随着时间的推移其强度如何发生变化。因此，研究者还会设定一个步长，时间窗会按照该步长从最开始的起点一直移动到脑电信号结束，在时间窗每发生一次移动后，就会进行一次傅里叶变换。此外，可以用每个时间窗的中点来代表这一整个时间窗。

最后，将所有时间窗的频域表达用一张横坐标为时间，纵坐标为正弦波频率，颜色深浅为正弦波强度的图来表示。

如上面右图所示，颜色越偏向红色就说明该正弦波的强度相对于标准强度更强，越偏向蓝色则代表相对于标准强度更弱。例如，在50ms 左右 30hz 以上的正弦 \\(\gamma\\) 波的强度就很大。200ms 左右 20到 30Hz 之间的正弦 \\(\beta\\) 波的强度就很小。

快速傅里叶变换 FFT 和 短时傅里叶变换 STFT 没有本质差异，只不过优化了数学算法，提高了变换效率。

最后，脑电信号一般并非周期性的正弦波，而是存在明显起止的纺锤波，如下图右侧所示。因此在短时傅里叶变换中，相较于将脑电信号拆分为周期性正弦波，更加的处理方案是拆分为纺锤波。

![](https://raw.githubusercontent.com/BurningSky0306/Img/main/Img/202503102207652.png)

